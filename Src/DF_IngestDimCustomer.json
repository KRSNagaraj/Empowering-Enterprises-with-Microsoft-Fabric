{"name":"DF_IngestDimCustomer","ppdf:dataflowId":"ee4af107-584f-4060-b6ae-c162fb0a0b1e","ppdf:owner":{"tenantId":"b2ed1379-e82c-4377-aacc-7b73a1773384","userId":"83a8454e-f40d-44ee-8fa3-784bccaaa959"},"ppdf:fastCopy":false,"version":"1.0","culture":"en-GB","modifiedTime":"2023-09-16T10:09:46.3903381+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"Dim_Customer":{"queryId":"af9ec26c-c402-4061-b3bf-dc9d99e999ae","queryName":"Dim_Customer","loadEnabled":true},"DefaultStaging":{"queryId":"44fc6b3d-dca9-4efe-a9ac-49a120437d28","queryName":"DefaultStaging"},"DestinationForWriteToDatabaseTableFrom_Dim_Customer":{"queryId":"3c5a4df8-bd65-4c3a-b58a-6e40e4544abb","queryName":"DestinationForWriteToDatabaseTableFrom_Dim_Customer"},"WriteToDatabaseTableFrom_TransformForOutputToDatabaseTableFrom_Dim_Customer":{"queryId":"eb7ab706-04ab-47db-ab35-1dfb7d923674","queryName":"WriteToDatabaseTableFrom_TransformForOutputToDatabaseTableFrom_Dim_Customer"},"TransformForOutputToDatabaseTableFrom_Dim_Customer":{"queryId":"a42c07fd-dfe2-4941-b22f-d118510b27f0","queryName":"TransformForOutputToDatabaseTableFrom_Dim_Customer"}},"document":"section Section1;\r\n[Staging = \"DefaultStaging\"]\r\nshared Dim_Customer = let\r\n  Source = Csv.Document(Web.Contents(\"https://raw.githubusercontent.com/microsoft/fabric-samples/689e78676174d4627fc3855165bde9100cb4d19e/docs-samples/data-engineering/dimension_customer.csv\"), [Delimiter = \",\", Columns = 11, Encoding = 65001, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"CustomerKey\", Int64.Type}, {\"WWICustomerID\", Int64.Type}, {\"Customer\", type text}, {\"BillToCustomer\", type text}, {\"Category\", type text}, {\"BuyingGroup\", type text}, {\"PrimaryContact\", type text}, {\"PostalCode\", type text}, {\"ValidFrom\", type datetime}, {\"ValidTo\", type datetime}, {\"LineageKey\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared DestinationForWriteToDatabaseTableFrom_Dim_Customer = let\r\n  Pattern = Lakehouse.Contents([]),\r\n  Navigation_1 = Pattern{[workspaceId = \"8ab8bf61-69a5-4cf9-8cf9-b3667eb5d213\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"3d59cee8-7c73-4ec9-a25c-fece7b2b3341\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Dim_Customer\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[CustomerKey = nullable Int64.Type, WWICustomerID = nullable Int64.Type, Customer = nullable text, BillToCustomer = nullable text, Category = nullable text, BuyingGroup = nullable text, PrimaryContact = nullable text, PostalCode = nullable text, ValidFrom = nullable datetime, ValidTo = nullable datetime, LineageKey = nullable Int64.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"DefaultStaging\"]\r\nshared WriteToDatabaseTableFrom_TransformForOutputToDatabaseTableFrom_Dim_Customer = let\r\n  WriteToDatabaseTableFrom_TransformForOutputToDatabaseTableFrom_Dim_Customer = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = DestinationForWriteToDatabaseTableFrom_Dim_Customer], (txn) => {TableAction.DeleteRows(txn[Target]), TableAction.InsertRows(txn[Target], TransformForOutputToDatabaseTableFrom_Dim_Customer), Action.DoNothing}))\r\nin\r\n  WriteToDatabaseTableFrom_TransformForOutputToDatabaseTableFrom_Dim_Customer;\r\nshared TransformForOutputToDatabaseTableFrom_Dim_Customer = let\r\n    SourceTable = Table.SelectColumns(Dim_Customer, {\"CustomerKey\", \"WWICustomerID\", \"Customer\", \"BillToCustomer\", \"Category\", \"BuyingGroup\", \"PrimaryContact\", \"PostalCode\", \"ValidFrom\", \"ValidTo\", \"LineageKey\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"https://github.com/microsoft/fabric-samples/blob/689e78676174d4627fc3855165bde9100cb4d19e/docs-samples/data-engineering/dimension_customer.csv","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://github.com/microsoft/fabric-samples/blob/689e78676174d4627fc3855165bde9100cb4d19e/docs-samples/data-engineering/dimension_customer.csv\"}","audience":null},{"path":"https://raw.githubusercontent.com/microsoft/fabric-samples/689e78676174d4627fc3855165bde9100cb4d19e/docs-samples/data-engineering/dimension_customer.csv","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://raw.githubusercontent.com/microsoft/fabric-samples/689e78676174d4627fc3855165bde9100cb4d19e/docs-samples/data-engineering/dimension_customer.csv\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"Dim_Customer","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Dim_Customer.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"CustomerKey","dataType":"int64"},{"name":"WWICustomerID","dataType":"int64"},{"name":"Customer","dataType":"string"},{"name":"BillToCustomer","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"BuyingGroup","dataType":"string"},{"name":"PrimaryContact","dataType":"string"},{"name":"PostalCode","dataType":"string"},{"name":"ValidFrom","dataType":"dateTime"},{"name":"ValidTo","dataType":"dateTime"},{"name":"LineageKey","dataType":"int64"}]}]}